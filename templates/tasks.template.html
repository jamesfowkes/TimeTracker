{% extends "view.template.html" %}

{% block nav %}
		<div id="left_nav" class="inactive_nav">
			<a href="{{url_for('clients')}}">Clients</a>
		</div>
		<div id="mid_nav" class="active_nav">
			<a href="{{url_for('active_jobs')}}">Jobs</a>
		</div>
		<div id="right_nav" class="inactive_nav">
			<a href="{{url_for('invoices')}}">Invoices</a>
		</div>

{% endblock %}

{% block content %}

{% with messages = get_flashed_messages() %}
	{% if messages %}
		<div id="errors">
		<p>The following errors were raised:</p>
		{% for message in messages %}
		<p>
		{{ message }}
		</p>
		{% endfor %}
		</div>
	{% endif %}
{% endwith %}

<p>
Showing tasks for {{ job_name }} for <a href="{{url_for('active_jobs_for_client', ClientID=client.id)}}">{{ client.name }}</a>.
</p>

<table class="sortable">
	<tr><th>Description</th><th>Rate</th><th>Date</th><th>Start</th><th>Finish</th><th>Hours</th><th>Total</th></tr>
	{% for task in tasks %}
	<tr>
		<td>
		    {{ task.desc }}
		    <a href="{{url_for('delete_task', job_name=job_name, ClientID=client.id, description=task.desc, date=task.date(), start=task.start(), finish=task.finish())}}">del</a>
		</td>
		<td>{{ task.rate("£%.2f") }}</td>
		<td sorttable_customkey={{task.table_sort_key()}}>{{ task.date() }}</td>
		<td>{{ task.start() }}</td>
		<td>{{ task.finish() }}</td>
		<td>{{ task.hours("%.2f") }}</td>
		<td>{{ task.total("£%.2f") }}</td>
	</tr>
	{% endfor %}
</table>
<div>
<p>Add new entry:</p>
<form action="{{url_for('add_new_task',ClientID=client.id, job_name=job_name)}}" method=post>
<label for="description">Description:</label><input type="text" id="description" name="description"/><br/>
<label for="rate">Rate (£):</label><input type="number" id="rate" name="rate" min="0" step="0.01" value="{{default_rate}}"/><br/>
<label for="workdate">Date:</label><input type="date" id="workdate" name="workdate" value="{{today('%Y-%m-%d')}}"/><br/>
<label for="start">Start:</label><input type="time" id="start" name="start" value="09:00"/><br/>
<label for="finish">Finish:</label><input type="time" id="finish" name="finish" value="17:00"/><br/>
<input type="submit" value="Add"/>
</form>
</div>
{% endblock %}


